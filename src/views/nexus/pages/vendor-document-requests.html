{% extends "nexus/layout.html" %}

{% block title %}Document Requests | Nexus Vendor{% endblock %}

{% block content %}
<div class="nexus-page-header">
  <div class="nexus-page-header-content">
    <h1 class="nexus-page-title">Document Requests</h1>
    <p class="nexus-page-subtitle">Documents requested by your clients</p>
  </div>
</div>

<div class="nexus-content-wrapper">
  <!-- Status Tabs -->
  <div class="nexus-tabs">
    <a href="/nexus/vendor/document-requests"
       class="nexus-tab {% if not activeStatus %}nexus-tab-active{% endif %}">
      All
    </a>
    <a href="/nexus/vendor/document-requests?status=requested"
       class="nexus-tab {% if activeStatus == 'requested' %}nexus-tab-active{% endif %}">
      ‚è≥ Pending
    </a>
    <a href="/nexus/vendor/document-requests?status=uploaded"
       class="nexus-tab {% if activeStatus == 'uploaded' %}nexus-tab-active{% endif %}">
      üì§ Uploaded
    </a>
    <a href="/nexus/vendor/document-requests?status=accepted"
       class="nexus-tab {% if activeStatus == 'accepted' %}nexus-tab-active{% endif %}">
      ‚úÖ Accepted
    </a>
    <a href="/nexus/vendor/document-requests?status=rejected"
       class="nexus-tab {% if activeStatus == 'rejected' %}nexus-tab-active{% endif %}">
      ‚ùå Rejected
    </a>
  </div>

  <!-- Requests List -->
  {% if requests.length > 0 %}
  <div class="nexus-card">
    <table class="nexus-table">
      <thead>
        <tr>
          <th>Document Type</th>
          <th>Related To</th>
          <th>Client</th>
          <th>Status</th>
          <th>Requested</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for req in requests %}
        <tr class="{% if req.status == 'requested' %}nexus-row-attention{% endif %}">
          <td>
            <span class="nexus-document-type">
              {{ documentTypeLabels[req.document_type] or req.document_type }}
            </span>
          </td>
          <td>
            <span class="nexus-entity-link">
              {{ req.entity_type | capitalize }}: {{ req.entity_id }}
            </span>
          </td>
          <td>{{ req.client_id }}</td>
          <td>
            <span class="nexus-badge nexus-badge-{{ req.status }}">
              {{ documentStatusLabels[req.status] or req.status }}
            </span>
          </td>
          <td>
            <span class="nexus-date">
              {{ req.created_at | date('MMM D, YYYY') }}
            </span>
          </td>
          <td>
            {% if req.status == 'requested' or req.status == 'rejected' %}
            <a href="/nexus/vendor/document-requests/{{ req.request_id }}"
               class="nexus-btn nexus-btn-sm nexus-btn-primary">
              Upload
            </a>
            {% else %}
            <a href="/nexus/vendor/document-requests/{{ req.request_id }}"
               class="nexus-btn nexus-btn-sm nexus-btn-secondary">
              View
            </a>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="nexus-empty-state">
    <div class="nexus-empty-icon">üìÑ</div>
    <h3>No document requests</h3>
    <p>
      {% if activeStatus %}
        No {{ activeStatus }} requests found. Try a different filter.
      {% else %}
        When clients request documents, they'll appear here.
      {% endif %}
    </p>
  </div>
  {% endif %}

  <!-- Summary -->
  <div class="nexus-summary-bar">
    <span class="nexus-summary-count">{{ total }} request{% if total != 1 %}s{% endif %}</span>
  </div>
</div>
{% endblock %}
