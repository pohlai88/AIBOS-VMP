{% extends "layout.html" %}

{% block title %}NexusCanon VMP â€” Case Console{% endblock %}

{% block content %}
<div class="vmp-container py-8 h-full flex flex-col">

    <header class="flex flex-wrap justify-between items-end gap-6 mb-8 shrink-0">
        <div class="min-w-0">
            <div class="vmp-label mb-2 opacity-70">// OPERATIONS / CONSOLE</div>
            <h1 class="vmp-h2 leading-none">
                Case Management
            </h1>
            <p class="mt-4 vmp-body max-w-[60ch] opacity-80">
                Monitor active vendor disputes, invoice exceptions, and approval workflows.
            </p>
        </div>

        <div class="flex items-center gap-3">
            <button class="vmp-btn vmp-btn-ghost">
                <span class="vmp-label">EXPORT CSV</span>
            </button>
            <button class="vmp-btn vmp-btn-primary" 
                    hx-get="/partials/modals/new-case" 
                    hx-target="#modal-container" 
                    hx-trigger="click">
                <span class="vmp-label text-black">CREATE CASE</span>
            </button>
        </div>
    </header>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8 shrink-0">
        
        <div class="vmp-panel p-4 flex flex-col justify-between h-32 relative overflow-hidden">
            <div class="flex justify-between items-start z-10">
                <div class="vmp-label opacity-60">ACTIVE CASES</div>
                <div class="vmp-badge vmp-badge-ok">LIVE</div>
            </div>
            <div class="vmp-h2 leading-none z-10">24</div>
            <div class="absolute -bottom-4 -right-4 opacity-5">
                <svg width="96" height="96" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
            </div>
        </div>

        <div class="vmp-panel p-4 flex flex-col justify-between h-32">
            <div class="flex justify-between items-start">
                <div class="vmp-label opacity-60">ACTION REQUIRED</div>
                <div class="vmp-badge vmp-badge-warn">ATTENTION</div>
            </div>
            <div class="vmp-h2 leading-none" style="color: var(--vmp-warn);">08</div>
        </div>

        <div class="vmp-panel p-4 flex flex-col justify-between h-32">
            <div class="flex justify-between items-start">
                <div class="vmp-label opacity-60">SLA CRITICAL</div>
                <div class="vmp-badge vmp-badge-danger">RISK</div>
            </div>
            <div class="vmp-h2 leading-none" style="color: var(--vmp-danger);">03</div>
        </div>
    </div>

    <section class="vmp-card flex flex-col flex-1 min-h-0">
        
        <div class="vmp-card-header flex justify-between items-center gap-4">
            <div class="relative w-full max-w-sm">
                <div class="absolute inset-y-0 left-3 flex items-center pointer-events-none opacity-50">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                </div>
                <input type="text" 
                       class="vmp-input pl-9" 
                       placeholder="Filter by Reference ID, Vendor, or Status..."
                       hx-get="/partials/case-list"
                       hx-trigger="keyup changed delay:500ms"
                       hx-target="#case-table-body"
                       name="q">
            </div>

            <div class="flex gap-2 hidden md:flex">
                <button class="vmp-btn vmp-btn-ghost vmp-btn-sm vmp-navlink-active">
                    <span class="vmp-label">ALL</span>
                </button>
                <button class="vmp-btn vmp-btn-ghost vmp-btn-sm">
                    <span class="vmp-label">OPEN</span>
                </button>
                <button class="vmp-btn vmp-btn-ghost vmp-btn-sm">
                    <span class="vmp-label">CLOSED</span>
                </button>
            </div>
        </div>

        <div class="flex-1 overflow-auto">
            <table class="vmp-table w-full">
                <thead>
                    <tr>
                        <th class="w-32">REF ID</th>
                        <th>SUBJECT</th>
                        <th>VENDOR</th>
                        <th class="w-40">STATUS</th>
                        <th class="w-32 text-right">DATE</th>
                        <th class="w-16"></th>
                    </tr>
                </thead>
                <tbody id="case-table-body">
                    {% for i in range(1, 6) %}
                    <tr class="cursor-pointer group" onclick="window.location.href='/cases/CAS-2024-00{{ i }}'">
                        <td>
                            <span class="vmp-code-small">CAS-2024-00{{ i }}</span>
                        </td>
                        <td>
                            <div class="vmp-body-small font-medium">Invoice Discrepancy #49{{ i }}2</div>
                            <div class="vmp-caption opacity-60">Pending approval from finance director</div>
                        </td>
                        <td>
                            <div class="flex items-center gap-2">
                                <div class="w-4 h-4 rounded-full bg-white/10"></div>
                                <span class="vmp-body-small">Acme Corp Ltd.</span>
                            </div>
                        </td>
                        <td>
                            {% if i % 3 == 0 %}
                                <span class="vmp-pill vmp-pill-disputed">CRITICAL</span>
                            {% elif i % 2 == 0 %}
                                <span class="vmp-pill vmp-pill-pending">REVIEW</span>
                            {% else %}
                                <span class="vmp-pill vmp-pill-matched">OPEN</span>
                            {% endif %}
                        </td>
                        <td class="text-right">
                            <span class="vmp-code-small opacity-60">Oct 2{{ i }}</span>
                        </td>
                        <td class="text-right">
                            <button class="vmp-btn vmp-btn-ghost p-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                            </button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div class="vmp-card-footer flex justify-between items-center">
            <div class="vmp-caption opacity-60">Showing 1-5 of 24 items</div>
            <div class="flex gap-2">
                <button class="vmp-btn vmp-btn-outline vmp-btn-sm" disabled>
                    <span class="vmp-label">PREV</span>
                </button>
                <button class="vmp-btn vmp-btn-outline vmp-btn-sm">
                    <span class="vmp-label">NEXT</span>
                </button>
            </div>
        </div>

    </section>

</div>
{% endblock %}