<div class="flex flex-col h-full">
    <div class="sticky top-0 z-10 vmp-component-card-header backdrop-blur-md flex gap-2 overflow-x-auto py-3">
        <button class="vmp-tag vmp-tag-mono hover:bg-white/5 transition-colors vmp-navigation-link-active">
            ALL ({{ cases|length }})
        </button>
        <button class="vmp-tag vmp-tag-mono opacity-60 hover:opacity-100 hover:bg-white/5 transition-opacity">
            ACTION (2)
        </button>
        <button class="vmp-tag vmp-tag-mono opacity-60 hover:opacity-100 hover:bg-white/5 transition-opacity">
            WAITING (5)
        </button>
    </div>

    <div class="divide-y vmp-border-color">
        {% for c in cases %}
        <a href="#" 
           class="group block px-4 py-3.5 hover:bg-white/[0.02] active:bg-white/[0.04] transition-all relative overflow-hidden"
           hx-get="/partials/case-detail.html?case_id={{ c.id }}" 
           hx-target="#case-detail-panel" 
           hx-swap="innerHTML"
           hx-indicator="#detail-loading">
            
            <div class="absolute left-0 top-0 bottom-0 w-[2px] bg-white opacity-0 transition-opacity"></div>

            <div class="flex items-start justify-between gap-3">
                
                <div class="flex items-start gap-3 min-w-0">
                    <div class="mt-1.5 relative shrink-0">
                        {% set st = (c.status or '') | lower %}
                        {% if st == 'waiting_supplier' %}
                            <div class="w-1.5 h-1.5 rounded-full vmp-fill-danger animate-pulse"></div>
                            <div class="absolute inset-0 vmp-fill-danger blur-[4px] opacity-40"></div>
                        {% elif st == 'open' %}
                             <div class="w-1.5 h-1.5 rounded-full vmp-fill-warn"></div>
                        {% elif st == 'resolved' %}
                             <div class="w-1.5 h-1.5 rounded-full vmp-fill-ok opacity-50"></div>
                        {% else %}
                             <div class="w-1.5 h-1.5 rounded-full vmp-bg-panel"></div>
                        {% endif %}
                    </div>

                    <div class="min-w-0">
                        <div class="flex items-center gap-2 mb-1">
                            <span class="vmp-code">#{{ c.id|string|truncate(8, True, '') }}</span>
                            <span class="vmp-caption vmp-muted truncate max-w-[140px]">{{ c.vmp_companies.name if c.vmp_companies else 'Unknown Entity' }}</span>
                        </div>
                        
                        <div class="vmp-body-small leading-snug truncate group-hover:text-white transition-colors">
                            {{ c.subject }}
                        </div>
                        
                        <div class="mt-2 flex items-center gap-2">
                             <span class="vmp-caption vmp-muted px-1.5 py-0.5 rounded vmp-bg-panel">{{ (c.case_type or 'General') }}</span>
                             <span class="vmp-code">
                                {% if c.updated_at %}
                                    {{ c.updated_at | date('%b %d') }}
                                {% else %}
                                    2h ago
                                {% endif %}
                             </span>
                        </div>
                    </div>
                </div>

                {% if st == 'waiting_supplier' %}
                    <div class="shrink-0 px-1.5 py-0.5 rounded border vmp-status-badge-danger">
                        <span class="vmp-label vmp-signal-danger">ACT</span>
                    </div>
                {% endif %}
            </div>
        </a>
        {% endfor %}
    </div>
</div>
