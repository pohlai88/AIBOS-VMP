{% if validationResult %}
<div class="p-6 border-b" style="border-color: var(--vmp-border);">
    
    <div class="mb-6">
        <h3 class="vmp-h4 mb-1">Data Validation</h3>
        <p class="vmp-caption opacity-60">AI-powered validation of case completeness</p>
    </div>

    <div class="mb-6">
        <div class="flex items-center justify-between mb-2">
            <span class="vmp-label opacity-70">Completeness</span>
            <span class="vmp-body-small font-medium font-mono">
                {{ (validationResult.completeness * 100) | round }}%
            </span>
        </div>
        <div class="w-full h-1.5 rounded-full overflow-hidden" style="background: var(--vmp-panel);">
            <div class="h-full transition-all duration-500 ease-out rounded-full"
                 style="width: {{ (validationResult.completeness * 100) | round }}%; 
                        background: {% if validationResult.completeness >= 1.0 %}var(--vmp-ok){% elif validationResult.completeness >= 0.5 %}var(--vmp-warn){% else %}var(--vmp-danger){% endif %};">
            </div>
        </div>
    </div>

    {% if validationResult.isValid %}
    <div class="p-3 mb-6 rounded-lg border flex items-center gap-3" 
         style="background: hsla(var(--vmp-ok-h), var(--vmp-ok-s), var(--vmp-ok-l), 0.1); border-color: var(--vmp-ok);">
        <div class="w-5 h-5 rounded-full grid place-items-center shrink-0" style="background: var(--vmp-ok);">
            <svg class="w-3 h-3 text-[var(--vmp-bg)]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" /></svg>
        </div>
        <span class="vmp-body-small font-medium" style="color: var(--vmp-ok);">All required documents verified</span>
    </div>
    {% else %}
    <div class="p-3 mb-6 rounded-lg border" 
         style="background: hsla(var(--vmp-warn-h), var(--vmp-warn-s), var(--vmp-warn-l), 0.1); border-color: var(--vmp-warn);">
        <div class="flex items-center gap-2 mb-1">
            <svg class="w-4 h-4" style="color: var(--vmp-warn);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
            <span class="vmp-body-small font-medium" style="color: var(--vmp-warn);">Action Required</span>
        </div>
        <p class="vmp-caption opacity-80 pl-6">
            {{ validationResult.missingRequired | length }} required document(s) missing
        </p>
    </div>
    {% endif %}

    {% if validationResult.missingRequired and validationResult.missingRequired.length > 0 %}
    <div class="mb-6">
        <h4 class="vmp-label mb-3 opacity-60">Missing Required Documents</h4>
        <ul class="space-y-3">
            {% for missing in validationResult.missingRequired %}
            <li class="flex items-start gap-3 group">
                <div class="mt-1 w-1.5 h-1.5 rounded-full shrink-0" style="background: var(--vmp-danger);"></div>
                <div class="flex-1 min-w-0">
                    <div class="vmp-body-small font-medium">{{ missing.stepLabel }}</div>
                    {% if missing.description %}
                    <div class="vmp-caption opacity-60 mt-0.5">{{ missing.description }}</div>
                    {% endif %}
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if validationResult.dataIssues and validationResult.dataIssues.length > 0 %}
    <div class="mb-6">
        <h4 class="vmp-label mb-3 opacity-60">Data Quality Issues</h4>
        <ul class="space-y-3">
            {% for issue in validationResult.dataIssues %}
            <li class="flex items-start gap-3">
                <div class="mt-1 w-1.5 h-1.5 rounded-full shrink-0" style="background: var(--vmp-warn);"></div>
                <div class="flex-1 min-w-0">
                    <div class="vmp-body-small">{{ issue.message }}</div>
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if validationResult.escalationRequired %}
    <div class="p-4 mb-6 rounded-lg border relative overflow-hidden" 
         style="background: hsla(var(--vmp-danger-h), var(--vmp-danger-s), var(--vmp-danger-l), 0.1); border-color: var(--vmp-danger);">
        <div class="absolute inset-0 opacity-5" 
             style="background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, currentColor 10px, currentColor 20px);"></div>
        
        <div class="relative z-10">
            <div class="flex items-center gap-2 mb-1.5">
                <svg class="w-4 h-4" style="color: var(--vmp-danger);" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
                <span class="vmp-body-small font-medium uppercase tracking-wide" style="color: var(--vmp-danger);">Escalation Required</span>
            </div>
            <p class="vmp-caption opacity-90 leading-relaxed">{{ validationResult.escalationReason }}</p>
        </div>
    </div>
    {% endif %}

    {% if validationResult.actionableRequests and validationResult.actionableRequests.length > 0 %}
    <div class="mb-6">
        <h4 class="vmp-label mb-3 opacity-60">Recommended Actions</h4>
        <div class="space-y-2">
            {% for request in validationResult.actionableRequests %}
            <div class="p-3 rounded-lg border transition-colors hover:bg-[var(--vmp-panel)]"
                 style="border-color: var(--vmp-border);">
                <div class="flex items-start justify-between gap-3">
                    <div class="flex-1 min-w-0">
                        <div class="vmp-body-small font-medium mb-1">{{ request.message }}</div>
                        {% if request.action.type == 'upload' %}
                        <a href="/cases/{{ caseId }}?action=upload&evidence_type={{ request.action.evidenceType }}&step_id={{ request.action.stepId }}"
                           class="inline-flex items-center gap-1 vmp-caption text-[var(--vmp-brand)] hover:underline">
                            Upload {{ request.action.evidenceType | replace('_', ' ') | title }}
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                        </a>
                        {% endif %}
                    </div>
                    
                    <span class="vmp-badge text-[9px] py-0 px-1.5 uppercase"
                          class="{% if request.priority == 'high' %}vmp-badge-danger{% elif request.priority == 'medium' %}vmp-badge-warn{% else %}vmp-badge-ok{% endif %}">
                        {{ request.priority }}
                    </span>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <div class="pt-4 border-t flex items-center justify-between" style="border-color: var(--vmp-border);">
        <span class="vmp-caption opacity-40">Validation Confidence</span>
        <div class="flex items-center gap-2">
            <div class="w-1.5 h-1.5 rounded-full" 
                 style="background: {% if validationResult.confidence > 0.8 %}var(--vmp-ok){% else %}var(--vmp-warn){% endif %};"></div>
            <span class="vmp-code-small opacity-80">
                {{ (validationResult.confidence * 100) | round }}%
            </span>
        </div>
    </div>
</div>
{% endif %}