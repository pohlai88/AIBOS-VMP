<!-- Data Ingest History Partial -->
<div class="space-y-6">
    {% if error %}
    <div class="p-4 mb-4 rounded-lg border vmp-border-warn vmp-bg-warn vmp-opacity-30">
        <div class="vmp-label vmp-text-warn">{{ error }}</div>
    </div>
    {% endif %}

    <div class="vmp-label-kicker vmp-label-kicker-strong mb-4">INGEST HISTORY</div>

    {% if history and history|length > 0 %}
    <div class="divide-y vmp-border-color">
        {% for entry in history %}
        <div class="p-4 hover:bg-white/[0.02] transition-colors">
            <div class="flex items-start justify-between gap-4">
                <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="vmp-code">{{ entry.ingest_type | upper }}</span>
                        <span class="vmp-body-small font-medium truncate">{{ entry.filename }}</span>
                    </div>
                    <div class="vmp-caption vmp-muted mb-2">
                        <span class="vmp-label-kicker opacity-50">Records:</span>
                        {{ entry.records_count }}
                        {% if entry.scope_type %}
                        <span class="vmp-label-kicker opacity-50 ml-3">Scope:</span>
                        {{ entry.scope_type | upper }}
                        {% endif %}
                    </div>
                    <div class="vmp-caption vmp-muted">
                        {% if entry.vmp_vendor_users %}
                        Uploaded by: {{ entry.vmp_vendor_users.display_name or entry.vmp_vendor_users.email }}
                        {% endif %}
                        <span class="ml-3">
                            {{ entry.created_at | date('%b %d, %Y %H:%M') if entry.created_at else 'â€”' }}
                        </span>
                    </div>
                    {% if entry.metadata and (entry.metadata.errors or entry.metadata.failures) %}
                    <div class="mt-2">
                        {% if entry.metadata.errors and entry.metadata.errors|length > 0 %}
                        <div class="vmp-caption vmp-text-warn">
                            {{ entry.metadata.errors|length }} error(s)
                        </div>
                        {% endif %}
                        {% if entry.metadata.failures and entry.metadata.failures|length > 0 %}
                        <div class="vmp-caption vmp-text-warn">
                            {{ entry.metadata.failures|length }} failure(s)
                        </div>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                <div class="shrink-0">
                    <span class="vmp-tag vmp-tag-mono text-xs">
                        {{ entry.ingest_type | upper }}
                    </span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="vmp-body vmp-muted text-center py-8">
        {% if error %}
        {{ error }}
        {% else %}
        No ingest history found.
        {% endif %}
    </div>
    {% endif %}
</div>

