<div x-data="{ 
  open: false,
  type: 'cases',
  format: 'csv',
  init() {
      // Listen for custom event to open modal
      document.addEventListener('open-export-modal', (e) => {
          this.type = e.detail?.type || 'cases';
          this.open = true;
      });
  }
}"
x-show="open"
class="vmp-modal-overlay"
style="display: none;"
x-transition.opacity>

<div class="vmp-modal" 
   @click.outside="open = false"
   x-transition:enter="ease-out duration-200"
   x-transition:enter-start="opacity-0 scale-95"
   x-transition:enter-end="opacity-100 scale-100">
  
  <div class="vmp-modal-header flex justify-between items-center">
      <div>
          <h3 class="vmp-h4">Export Data</h3>
          <p class="vmp-caption opacity-60 mt-1">Configure your download format.</p>
      </div>
      <button class="vmp-modal-close" @click="open = false">Ã—</button>
  </div>

  <div class="vmp-modal-body space-y-6">
      
      <div>
          <div class="vmp-label mb-3 opacity-70">File Format</div>
          <div class="grid grid-cols-1 gap-2">
              <label class="flex items-center gap-3 p-3 rounded border cursor-pointer hover:bg-[var(--vmp-panel)]" style="border-color: var(--vmp-border);">
                  <input type="radio" name="format" value="csv" x-model="format" class="vmp-radio">
                  <div>
                      <div class="vmp-body-small font-medium">CSV (Comma Separated)</div>
                      <div class="vmp-caption opacity-50">Best for Excel or Google Sheets.</div>
                  </div>
              </label>
              <label class="flex items-center gap-3 p-3 rounded border cursor-pointer hover:bg-[var(--vmp-panel)]" style="border-color: var(--vmp-border);">
                  <input type="radio" name="format" value="json" x-model="format" class="vmp-radio">
                  <div>
                      <div class="vmp-body-small font-medium">JSON (Machine Readable)</div>
                      <div class="vmp-caption opacity-50">Full dataset including nested metadata.</div>
                  </div>
              </label>
              <label class="flex items-center gap-3 p-3 rounded border cursor-pointer hover:bg-[var(--vmp-panel)]" style="border-color: var(--vmp-border);">
                  <input type="radio" name="format" value="pdf" x-model="format" class="vmp-radio">
                  <div>
                      <div class="vmp-body-small font-medium">PDF (Report)</div>
                      <div class="vmp-caption opacity-50">Formatted for print/audit trail.</div>
                  </div>
              </label>
          </div>
      </div>

      <div class="flex items-center gap-2">
          <input type="checkbox" id="include_archived" class="vmp-checkbox">
          <label for="include_archived" class="vmp-body-small opacity-80 cursor-pointer">Include archived records</label>
      </div>
  </div>

  <div class="vmp-modal-footer">
      <button class="vmp-btn vmp-btn-ghost" @click="open = false">Cancel</button>
      <button class="vmp-btn vmp-btn-primary" @click="window.location.href=`/api/export/${type}?format=${format}`; open = false">
          <span class="vmp-label text-[var(--vmp-bg)]">Download File</span>
      </button>
  </div>
</div>
</div>

<script>
// Helper to trigger this from anywhere
function openCustomExportModal(type) {
  document.dispatchEvent(new CustomEvent('open-export-modal', { detail: { type } }));
}
</script>