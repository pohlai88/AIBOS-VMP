<!-- Invoice List Partial -->
<div class="flex flex-col h-full">
    {% if error %}
    <div class="p-3 m-4 rounded-lg border vmp-border-warn vmp-bg-warn vmp-opacity-30">
        <div class="vmp-caption vmp-text-warn">{{ error }}</div>
    </div>
    {% endif %}

    <!-- Filters -->
    <div class="sticky top-0 z-10 vmp-component-card-header backdrop-blur-md flex gap-2 overflow-x-auto py-3 mb-4">
        <form hx-get="/partials/invoice-list.html" 
              hx-target="#invoice-list-container" 
              hx-swap="innerHTML"
              class="flex gap-2 items-center">
            <input type="text" 
                   name="search" 
                   placeholder="Search invoice #..." 
                   class="vmp-form-input text-sm"
                   value="{{ request.query.search or '' }}">
            <select name="status" class="vmp-form-input text-sm">
                <option value="">All Status</option>
                <option value="pending" {% if request.query.status == 'pending' %}selected{% endif %}>Pending</option>
                <option value="matched" {% if request.query.status == 'matched' %}selected{% endif %}>Matched</option>
                <option value="paid" {% if request.query.status == 'paid' %}selected{% endif %}>Paid</option>
                <option value="disputed" {% if request.query.status == 'disputed' %}selected{% endif %}>Disputed</option>
            </select>
            <button type="submit" class="vmp-btn-outline text-sm">Filter</button>
        </form>
    </div>

    <!-- Invoice List -->
    <div class="divide-y vmp-border-color">
        {% if invoices and invoices|length > 0 %}
        {% for invoice in invoices %}
        <a href="/invoices/{{ invoice.id }}" 
           class="group block px-4 py-3.5 hover:bg-white/[0.02] active:bg-white/[0.04] transition-all relative overflow-hidden">
            
            <div class="absolute left-0 top-0 bottom-0 w-[2px] bg-white opacity-0 group-hover:opacity-100 transition-opacity"></div>

            <div class="flex items-start justify-between gap-3">
                <div class="flex items-start gap-3 min-w-0 flex-1">
                    <div class="mt-1.5 relative shrink-0">
                        {% set st = (invoice.status or 'pending') | lower %}
                        {% if st == 'paid' %}
                            <div class="w-1.5 h-1.5 rounded-full vmp-fill-ok"></div>
                        {% elif st == 'matched' %}
                            <div class="w-1.5 h-1.5 rounded-full vmp-fill-warn"></div>
                        {% elif st == 'disputed' %}
                            <div class="w-1.5 h-1.5 rounded-full vmp-fill-danger animate-pulse"></div>
                        {% else %}
                            <div class="w-1.5 h-1.5 rounded-full vmp-bg-panel"></div>
                        {% endif %}
                    </div>

                    <div class="min-w-0 flex-1">
                        <div class="flex items-center gap-2 mb-1">
                            <span class="vmp-code">#{{ invoice.invoice_num }}</span>
                            <span class="vmp-caption vmp-muted">
                                {{ invoice.vmp_companies.name if invoice.vmp_companies else 'Unknown Company' }}
                            </span>
                        </div>
                        
                        <div class="vmp-body-small leading-snug truncate group-hover:text-white transition-colors">
                            {{ invoice.description or 'No description' }}
                        </div>
                        
                        <div class="mt-2 flex items-center gap-2">
                            <span class="vmp-caption vmp-muted">
                                {{ invoice.invoice_date | date('%b %d, %Y') if invoice.invoice_date else '—' }}
                            </span>
                            <span class="vmp-subtle">•</span>
                            <span class="vmp-code">
                                {{ invoice.currency_code or 'USD' }} {{ "%.2f"|format(invoice.amount) if invoice.amount else '0.00' }}
                            </span>
                        </div>
                    </div>
                </div>

                <div class="shrink-0">
                    <span class="vmp-tag vmp-tag-mono text-xs">
                        {{ (invoice.status or 'pending') | upper }}
                    </span>
                </div>
            </div>
        </a>
        {% endfor %}
        {% else %}
        <!-- Empty State -->
        <div class="flex items-center justify-center h-64">
            <div class="text-center">
                <div class="font-serif text-6xl italic opacity-35 mb-4">N</div>
                <div class="vmp-h3 mb-2">No Invoices</div>
                <div class="vmp-body vmp-muted">
                    No invoices found. Upload a CSV file to get started.
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>

