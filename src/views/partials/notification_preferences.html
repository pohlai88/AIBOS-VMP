<div class="vmp-panel p-0 border overflow-hidden" style="border-color: var(--vmp-border);">
    
    <div class="p-5 border-b flex justify-between items-center" style="border-color: var(--vmp-border);">
        <h3 class="vmp-h6">Alert Settings</h3>
        <div id="notification-preferences-loading" class="htmx-indicator flex items-center gap-2">
            <div class="vmp-spinner w-3 h-3"></div>
            <span class="vmp-caption opacity-50">Saving...</span>
        </div>
    </div>
    
    <form hx-post="/profile/notification-preferences" 
          hx-target="#notification-preferences-container" 
          hx-swap="innerHTML"
          hx-indicator="#notification-preferences-loading"
          class="divide-y"
          style="divide-color: var(--vmp-border);">
        
        <div class="p-5 flex items-start justify-between gap-4">
            <div>
                <div class="vmp-body-small font-medium mb-1">Email Digest</div>
                <div class="vmp-caption opacity-60 max-w-sm">Receive summaries for payment receipts and critical case updates.</div>
            </div>
            <label class="flex items-center gap-3 cursor-pointer">
                <span class="vmp-code-small opacity-50">{{ 'ON' if preferences.email != false else 'OFF' }}</span>
                <input type="checkbox" name="email" value="true" class="vmp-checkbox" 
                       {% if preferences and preferences.email != false %}checked{% endif %}>
            </label>
        </div>

        <div class="p-5 flex items-start justify-between gap-4">
            <div>
                <div class="vmp-body-small font-medium mb-1">SMS Alerts</div>
                <div class="vmp-caption opacity-60 max-w-sm">Urgent notifications for payment failures or break-glass events.</div>
                {% if not user.phone %}
                <div class="mt-2 vmp-caption text-[var(--vmp-warn)] flex items-center gap-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                    Mobile number required
                </div>
                {% endif %}
            </div>
            <label class="flex items-center gap-3 cursor-pointer {{ 'opacity-50 cursor-not-allowed' if not user.phone }}">
                <span class="vmp-code-small opacity-50">{{ 'ON' if preferences.sms == true else 'OFF' }}</span>
                <input type="checkbox" name="sms" value="true" class="vmp-checkbox" 
                       {% if preferences and preferences.sms == true %}checked{% endif %}
                       {% if not user.phone %}disabled{% endif %}>
            </label>
        </div>

        <div class="p-5 flex items-start justify-between gap-4">
            <div>
                <div class="vmp-body-small font-medium mb-1">Browser Push</div>
                <div class="vmp-caption opacity-60 max-w-sm">Real-time desktop notifications when the app is open.</div>
            </div>
            <label class="flex items-center gap-3 cursor-pointer">
                <span class="vmp-code-small opacity-50">{{ 'ON' if preferences.push != false else 'OFF' }}</span>
                <input type="checkbox" name="push" value="true" class="vmp-checkbox" 
                       {% if not preferences or preferences.push != false %}checked{% endif %}>
            </label>
        </div>

        <div class="p-5 bg-[var(--vmp-panel)] flex justify-end gap-3">
            <button type="button" 
                    class="vmp-btn vmp-btn-ghost vmp-btn-sm"
                    onclick="document.getElementById('notification-preferences-container').innerHTML = ''">
                Close
            </button>
            <button type="submit" class="vmp-btn vmp-btn-primary vmp-btn-sm">
                Update Preferences
            </button>
        </div>
    </form>
</div>