<div class="space-y-4">
    <div class="vmp-panel p-3 border flex flex-wrap items-center gap-3 sticky top-0 z-10 shadow-lg" 
         style="border-color: var(--vmp-border);">
        <form hx-get="/partials/ops-case-queue.html"
              hx-target="#case-queue-container"
              hx-swap="innerHTML"
              class="flex-1 flex gap-3 items-center flex-wrap">
            
            <div class="flex items-center gap-2 px-2 border-r" style="border-color: var(--vmp-border);">
                <svg class="w-4 h-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path></svg>
                <span class="vmp-code-small opacity-60">FILTER</span>
            </div>

            <select name="status" class="vmp-input-sm bg-transparent border-0 focus:ring-0 vmp-code-small cursor-pointer hover:text-white transition-colors"
                    onchange="this.form.requestSubmit()">
                <option value="" class="bg-black">All Status</option>
                <option value="open" class="bg-black" {% if filters.status == 'open' %}selected{% endif %}>Open</option>
                <option value="resolved" class="bg-black" {% if filters.status == 'resolved' %}selected{% endif %}>Resolved</option>
                <option value="closed" class="bg-black" {% if filters.status == 'closed' %}selected{% endif %}>Closed</option>
            </select>

            <select name="owner_team" class="vmp-input-sm bg-transparent border-0 focus:ring-0 vmp-code-small cursor-pointer hover:text-white transition-colors"
                    onchange="this.form.requestSubmit()">
                <option value="" class="bg-black">All Teams</option>
                <option value="procurement" class="bg-black" {% if filters.owner_team == 'procurement' %}selected{% endif %}>Procurement</option>
                <option value="ap" class="bg-black" {% if filters.owner_team == 'ap' %}selected{% endif %}>AP</option>
                <option value="finance" class="bg-black" {% if filters.owner_team == 'finance' %}selected{% endif %}>Finance</option>
            </select>
        </form>
    </div>

    <div class="vmp-panel border overflow-hidden" style="border-color: var(--vmp-border);">
        {% if cases and cases|length > 0 %}
        <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse">
                <thead>
                    <tr class="border-b bg-[var(--vmp-background-secondary)]" style="border-color: var(--vmp-border);">
                        <th class="p-3 vmp-code-small opacity-50 font-normal w-12">Esc</th>
                        <th class="p-3 vmp-code-small opacity-50 font-normal">Case Ref</th>
                        <th class="p-3 vmp-code-small opacity-50 font-normal">Subject</th>
                        <th class="p-3 vmp-code-small opacity-50 font-normal">Team</th>
                        <th class="p-3 vmp-code-small opacity-50 font-normal">Updated</th>
                        <th class="p-3 vmp-code-small opacity-50 font-normal text-right">Status</th>
                    </tr>
                </thead>
                <tbody class="divide-y" style="divide-color: var(--vmp-border);">
                    {% for case in cases %}
                    <tr class="group hover:bg-[var(--vmp-background-hover)] transition-colors cursor-pointer"
                        onclick="window.location='/ops/cases/{{ case.id }}'">
                        
                        <td class="p-3 text-center">
                            {% if case.escalation_level >= 3 %}
                                <div class="w-2 h-2 rounded-full bg-[var(--vmp-danger)] mx-auto animate-pulse shadow-[0_0_8px_var(--vmp-danger)]"></div>
                            {% elif case.escalation_level >= 2 %}
                                <div class="w-2 h-2 rounded-full bg-[var(--vmp-warn)] mx-auto"></div>
                            {% else %}
                                <div class="w-2 h-2 rounded-full bg-[var(--vmp-border)] mx-auto opacity-30"></div>
                            {% endif %}
                        </td>

                        <td class="p-3">
                            <div class="flex flex-col">
                                <span class="vmp-code-small text-[var(--vmp-brand)]">#{{ case.id | truncate(8, True, '') }}</span>
                                <span class="vmp-caption text-[10px] opacity-50">{{ case.case_type | upper }}</span>
                            </div>
                        </td>

                        <td class="p-3 max-w-md">
                            <div class="vmp-body-small font-medium truncate mb-0.5">{{ case.subject or 'No subject' }}</div>
                            {% if case.vmp_companies %}
                            <div class="vmp-caption opacity-60 flex items-center gap-1">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>
                                {{ case.vmp_companies.name }}
                            </div>
                            {% endif %}
                        </td>

                        <td class="p-3">
                            <span class="vmp-badge vmp-badge-outline text-[10px]">
                                {{ case.owner_team | upper if case.owner_team else 'UNASSIGNED' }}
                            </span>
                        </td>

                        <td class="p-3 vmp-caption opacity-60">
                            {{ case.updated_at | date('%b %d') if case.updated_at else 'â€”' }}
                        </td>

                        <td class="p-3 text-right">
                            <span class="vmp-tag {{ 'vmp-tag-mono' if case.status == 'open' else 'opacity-50 border border-white/10' }}">
                                {{ (case.status or 'open') | upper }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="vmp-empty py-12 text-center">
            <div class="vmp-empty-title">Queue Clear</div>
            <div class="vmp-empty-description">No cases match your filters.</div>
        </div>
        {% endif %}
    </div>
</div>