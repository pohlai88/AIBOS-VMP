<!-- SLA Performance Table Partial -->
<div class="space-y-6">
    {% if slaMetrics %}
    {% set byTeam = slaMetrics.byTeam %}
    {% set byCompany = slaMetrics.byCompany %}
    {% set byCaseType = slaMetrics.byCaseType %}
    {% if byTeam or byCompany or byCaseType %}

    <!-- Performance by Team -->
    {% if byTeam %}
    <div class="vmp-panel p-6 border vmp-border-color">
        <div class="vmp-label-kicker vmp-label-kicker-strong mb-4">PERFORMANCE BY TEAM</div>
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b vmp-border-color">
                        <th class="text-left py-2 vmp-label-kicker">Team</th>
                        <th class="text-right py-2 vmp-label-kicker">Total Cases</th>
                        <th class="text-right py-2 vmp-label-kicker">Within SLA</th>
                        <th class="text-right py-2 vmp-label-kicker">Breached</th>
                        <th class="text-right py-2 vmp-label-kicker">Compliance Rate</th>
                        <th class="text-right py-2 vmp-label-kicker">Avg Response Time</th>
                    </tr>
                </thead>
                <tbody>
                    {% for team, metrics in byTeam.items() %}
                    <tr class="border-b vmp-border-color">
                        <td class="py-2 vmp-body-small">{{ team | upper }}</td>
                        <td class="py-2 text-right vmp-body-small">{{ metrics.total }}</td>
                        <td class="py-2 text-right vmp-body-small vmp-signal-ok">{{ metrics.withinSLA }}</td>
                        <td class="py-2 text-right vmp-body-small {% if metrics.breached > 0 %}vmp-signal-danger{% else %}vmp-muted{% endif %}">{{ metrics.breached }}</td>
                        <td class="py-2 text-right vmp-body-small {% if metrics.complianceRate >= 90 %}vmp-signal-ok{% elif metrics.complianceRate >= 70 %}vmp-signal-warn{% else %}vmp-signal-danger{% endif %}">
                            {{ "%.1f"|format(metrics.complianceRate) }}%
                        </td>
                        <td class="py-2 text-right vmp-body-small {% if metrics.averageResponseTime <= 2 %}vmp-signal-ok{% elif metrics.averageResponseTime <= 4 %}vmp-signal-warn{% else %}vmp-signal-danger{% endif %}">
                            {{ "%.1f"|format(metrics.averageResponseTime) }}h
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    <!-- Performance by Company -->
    {% if byCompany %}
    <div class="vmp-panel p-6 border vmp-border-color">
        <div class="vmp-label-kicker vmp-label-kicker-strong mb-4">PERFORMANCE BY COMPANY</div>
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b vmp-border-color">
                        <th class="text-left py-2 vmp-label-kicker">Company</th>
                        <th class="text-right py-2 vmp-label-kicker">Total Cases</th>
                        <th class="text-right py-2 vmp-label-kicker">Within SLA</th>
                        <th class="text-right py-2 vmp-label-kicker">Breached</th>
                        <th class="text-right py-2 vmp-label-kicker">Compliance Rate</th>
                        <th class="text-right py-2 vmp-label-kicker">Avg Response Time</th>
                    </tr>
                </thead>
                <tbody>
                    {% for company, metrics in byCompany.items() %}
                    <tr class="border-b vmp-border-color">
                        <td class="py-2 vmp-body-small">{{ company }}</td>
                        <td class="py-2 text-right vmp-body-small">{{ metrics.total }}</td>
                        <td class="py-2 text-right vmp-body-small vmp-signal-ok">{{ metrics.withinSLA }}</td>
                        <td class="py-2 text-right vmp-body-small {% if metrics.breached > 0 %}vmp-signal-danger{% else %}vmp-muted{% endif %}">{{ metrics.breached }}</td>
                        <td class="py-2 text-right vmp-body-small {% if metrics.complianceRate >= 90 %}vmp-signal-ok{% elif metrics.complianceRate >= 70 %}vmp-signal-warn{% else %}vmp-signal-danger{% endif %}">
                            {{ "%.1f"|format(metrics.complianceRate) }}%
                        </td>
                        <td class="py-2 text-right vmp-body-small {% if metrics.averageResponseTime <= 2 %}vmp-signal-ok{% elif metrics.averageResponseTime <= 4 %}vmp-signal-warn{% else %}vmp-signal-danger{% endif %}">
                            {{ "%.1f"|format(metrics.averageResponseTime) }}h
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    <!-- Performance by Case Type -->
    {% if byCaseType %}
    <div class="vmp-panel p-6 border vmp-border-color">
        <div class="vmp-label-kicker vmp-label-kicker-strong mb-4">PERFORMANCE BY CASE TYPE</div>
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead>
                    <tr class="border-b vmp-border-color">
                        <th class="text-left py-2 vmp-label-kicker">Case Type</th>
                        <th class="text-right py-2 vmp-label-kicker">Total Cases</th>
                        <th class="text-right py-2 vmp-label-kicker">Within SLA</th>
                        <th class="text-right py-2 vmp-label-kicker">Breached</th>
                        <th class="text-right py-2 vmp-label-kicker">Compliance Rate</th>
                        <th class="text-right py-2 vmp-label-kicker">Avg Response Time</th>
                    </tr>
                </thead>
                <tbody>
                    {% for caseType, metrics in byCaseType.items() %}
                    <tr class="border-b vmp-border-color">
                        <td class="py-2 vmp-body-small">{{ caseType | upper }}</td>
                        <td class="py-2 text-right vmp-body-small">{{ metrics.total }}</td>
                        <td class="py-2 text-right vmp-body-small vmp-signal-ok">{{ metrics.withinSLA }}</td>
                        <td class="py-2 text-right vmp-body-small {% if metrics.breached > 0 %}vmp-signal-danger{% else %}vmp-muted{% endif %}">{{ metrics.breached }}</td>
                        <td class="py-2 text-right vmp-body-small {% if metrics.complianceRate >= 90 %}vmp-signal-ok{% elif metrics.complianceRate >= 70 %}vmp-signal-warn{% else %}vmp-signal-danger{% endif %}">
                            {{ "%.1f"|format(metrics.complianceRate) }}%
                        </td>
                        <td class="py-2 text-right vmp-body-small {% if metrics.averageResponseTime <= 2 %}vmp-signal-ok{% elif metrics.averageResponseTime <= 4 %}vmp-signal-warn{% else %}vmp-signal-danger{% endif %}">
                            {{ "%.1f"|format(metrics.averageResponseTime) }}h
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    {% else %}
    <div class="vmp-panel p-6 border vmp-border-color">
        <div class="vmp-body vmp-muted text-center py-8">
            No performance data available for the selected period.
        </div>
    </div>
    {% endif %}
</div>

