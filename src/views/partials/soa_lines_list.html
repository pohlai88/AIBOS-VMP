<!-- SOA Lines List (filtered) -->
{% if soaLines and soaLines.length > 0 %}
  {% for line in soaLines %}
    <button
      class="vmp-case-item"
      style="width: 100%; text-align: left; margin-bottom: var(--vmp-space-2);"
      hx-get="/soa/{{ caseId }}/lines/{{ line.id }}/focus"
      hx-trigger="click"
      hx-target="#soa-focus"
      hx-swap="innerHTML">
      <div style="display: flex; align-items: flex-start; justify-content: space-between; gap: var(--vmp-space-3);">
        <div style="min-width: 0;">
          <div class="vmp-label" style="font-size: var(--vmp-font-xs); text-transform: uppercase; letter-spacing: var(--vmp-letter-spacing-wider); color: var(--vmp-subtle);">
            INV Â· {{ line.invoice_date or 'N/A' }}
          </div>
          <div style="margin-top: var(--vmp-space-1); font-size: var(--vmp-font-sm); color: var(--vmp-text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
            {{ line.invoice_number or 'N/A' }}
          </div>
          <div style="margin-top: var(--vmp-space-1); font-size: var(--vmp-font-xs); color: var(--vmp-subtle);">
            Amount: <span style="color: var(--vmp-text);">{{ line.currency_code }} {{ "%.2f"|format(line.amount) }}</span>
          </div>
        </div>

        <span class="vmp-pill
          {% if line.status == 'matched' %}vmp-pill-ok
          {% elif line.status == 'discrepancy' %}vmp-pill-danger
          {% else %}vmp-pill-warn{% endif %}">
          {% if line.status == 'matched' %}MATCHED
          {% elif line.status == 'discrepancy' %}DISPUTED
          {% else %}UNMATCHED{% endif %}
        </span>
      </div>
    </button>
  {% endfor %}
{% else %}
  <div class="vmp-empty" style="text-align: center; padding: var(--vmp-space-8);">
    <p class="vmp-body" style="color: var(--vmp-subtle);">No SOA lines found</p>
  </div>
{% endif %}

