<div class="h-full flex flex-col" x-data>
    <div class="h-9 bg-white/5 border-b border-white/5 flex items-center justify-between px-3 shrink-0 cursor-grab active:cursor-grabbing">
        <div class="flex items-center gap-2">
            <div class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></div>
            <span class="font-mono text-[9px] uppercase tracking-widest text-emerald-500/80">Financial_Radar</span>
        </div>
        <button hx-get="/supplier/radar" 
                hx-target="#radar-content" 
                hx-swap="innerHTML"
                class="text-white/20 hover:text-white transition-colors">
            <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
        </button>
    </div>

    <div class="p-6 flex-1 overflow-y-auto custom-scrollbar">
        
        <div class="mb-6 relative group">
            <div class="absolute -left-2 -right-2 -top-2 -bottom-2 bg-white/5 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity"></div>
            <div class="relative">
                <div class="font-mono text-[9px] text-white/40 uppercase tracking-widest mb-1">Last Remittance</div>
                <div class="font-serif text-3xl text-white tracking-tight">
                    {% if last_payment and last_payment.amount %}
                        ${{ "%.2f"|format(last_payment.amount) }}
                    {% else %}
                        $0.00
                    {% endif %}
                </div>
                <div class="flex items-center justify-between mt-1">
                    <div class="font-mono text-[9px] text-emerald-400">
                        {% if last_payment and last_payment.payment_date %}
                            {{ last_payment.payment_date | date('%b %d') }}
                        {% else %}
                            —
                        {% endif %}
                    </div>
                    {% if last_payment and last_payment.remittance_url %}
                    <a href="/payments/{{ last_payment.id }}/remittance" class="text-[9px] border-b border-white/20 hover:border-white text-white/60 hover:text-white transition-colors pb-px">
                        PDF
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="h-px bg-white/10 w-full mb-4"></div>

        <div class="space-y-3">
            <div class="flex justify-between items-end mb-2">
                <span class="font-mono text-[9px] uppercase text-white/30">In Flight</span>
                <span class="font-mono text-[9px] text-white/30">EST. DATE</span>
            </div>

            {% if pending_invoices and pending_invoices|length > 0 %}
                {% for inv in pending_invoices %}
                <div class="flex justify-between items-center group cursor-default">
                    <div class="flex items-center gap-2">
                        <div class="w-1 h-1 rounded-full {{ 'bg-yellow-500' if inv.status == 'scheduled' else 'bg-blue-500' }}"></div>
                        <span class="font-sans text-xs text-white/80 group-hover:text-white transition-colors">{{ inv.invoice_num or inv.id }}</span>
                    </div>
                    <div class="text-right">
                        <div class="font-mono text-xs text-white/60">
                            {% if inv.amount %}
                                ${{ "%.2f"|format(inv.amount) }}
                            {% else %}
                                —
                            {% endif %}
                        </div>
                        <div class="font-mono text-[8px] text-white/20">
                            {% if inv.due_date %}
                                {{ inv.due_date | date('%b %d') }}
                            {% elif inv.invoice_date %}
                                {{ inv.invoice_date | date('%b %d') }}
                            {% else %}
                                —
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="text-center py-4">
                    <span class="font-mono text-[9px] text-white/20">NO ACTIVE PIPELINE</span>
                </div>
            {% endif %}
        </div>
    </div>
</div>

