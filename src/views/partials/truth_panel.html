<!-- Truth Panel Partial (Sprint 8) - Wireframe Pattern -->
<div class="vmp-truth-panel">
    {% if invoice %}
    <div class="vmp-truth-item">
        <div class="vmp-label-kicker">INVOICE</div>
        <div class="vmp-h3 mb-3">
            <a href="/invoices/{{ invoice.id }}" class="hover:opacity-80 transition-opacity">
                {{ invoice.invoice_num or 'INV-' + invoice.id|string|truncate(8, True, '') }}
            </a>
        </div>
        <div class="vmp-body-small space-y-2">
            {% if invoice.status %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Status:</span>
                <span class="vmp-pill vmp-pill-{{ invoice.status|lower }}" role="status" aria-label="Invoice status: {{ invoice.status|upper }}">{{ invoice.status|upper }}</span>
            </div>
            {% endif %}
            {% if invoice.amount %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Amount:</span>
                <span class="vmp-body">{{ invoice.currency_code or 'USD' }} {{ "%.2f"|format(invoice.amount) }}</span>
            </div>
            {% endif %}
            {% if linkedCases %}
            <div class="flex items-center gap-2 flex-wrap">
                <span class="vmp-muted">Linked:</span>
                {% for case in linkedCases %}
                <a href="/cases/{{ case.id }}" class="vmp-code-small text-[var(--vmp-brand)] hover:opacity-80">Case #{{ case.id|string|truncate(8, True, '') }}</a>
                {% endfor %}
            </div>
            {% endif %}
            {% if linkedPayments %}
            <div class="flex items-center gap-2 flex-wrap">
                <span class="vmp-muted">Payments:</span>
                {% for payment in linkedPayments %}
                <a href="/payments/{{ payment.id }}" class="vmp-code-small text-[var(--vmp-brand)] hover:opacity-80">Payment #{{ payment.id|string|truncate(8, True, '') }}</a>
                {% endfor %}
            </div>
            {% endif %}
            {% if evidenceCount is defined %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Evidence:</span>
                <span class="vmp-body">{{ evidenceCount or 0 }} file{{ 's' if (evidenceCount or 0) != 1 else '' }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    {% if purchaseOrder %}
    <div class="vmp-truth-item">
        <div class="vmp-label-kicker">PURCHASE ORDER</div>
        <div class="vmp-h3 mb-3">{{ purchaseOrder.po_number or 'PO-' + purchaseOrder.id|string|truncate(8, True, '') }}</div>
        <div class="vmp-body-small space-y-2">
            {% if purchaseOrder.amount %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Amount:</span>
                <span class="vmp-body">{{ purchaseOrder.currency_code or 'USD' }} {{ "%.2f"|format(purchaseOrder.amount) }}</span>
            </div>
            {% endif %}
            {% if purchaseOrder.po_date %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Date:</span>
                <span class="vmp-body">{{ purchaseOrder.po_date }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    {% if grn %}
    <div class="vmp-truth-item">
        <div class="vmp-label-kicker">GOODS RECEIVED NOTE</div>
        <div class="vmp-h3 mb-3">{{ grn.grn_number or 'GRN-' + grn.id|string|truncate(8, True, '') }}</div>
        <div class="vmp-body-small space-y-2">
            {% if grn.received_date %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Received:</span>
                <span class="vmp-body">{{ grn.received_date }}</span>
            </div>
            {% endif %}
            {% if grn.status %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Status:</span>
                <span class="vmp-pill vmp-pill-{{ grn.status|lower }}" role="status" aria-label="GRN status: {{ grn.status|upper }}">{{ grn.status|upper }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    {% if payment %}
    <div class="vmp-truth-item">
        <div class="vmp-label-kicker">PAYMENT</div>
        <div class="vmp-h3 mb-3">
            <a href="/payments/{{ payment.id }}" class="hover:opacity-80 transition-opacity">
                {{ payment.payment_ref or 'PAY-' + payment.id|string|truncate(8, True, '') }}
            </a>
        </div>
        <div class="vmp-body-small space-y-2">
            {% if payment.status %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Status:</span>
                <span class="vmp-pill vmp-pill-{{ payment.status|lower }}" role="status" aria-label="Payment status: {{ payment.status|upper }}">{{ payment.status|upper }}</span>
            </div>
            {% endif %}
            {% if payment.amount %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Amount:</span>
                <span class="vmp-body">{{ payment.currency_code or 'USD' }} {{ "%.2f"|format(payment.amount) }}</span>
            </div>
            {% endif %}
            {% if payment.payment_date %}
            <div class="flex items-center gap-2">
                <span class="vmp-muted">Date:</span>
                <span class="vmp-body">{{ payment.payment_date }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    {% if not invoice and not purchaseOrder and not grn and not payment %}
    <div class="vmp-empty">
        <div class="vmp-empty-title">No Transaction Context</div>
        <div class="vmp-empty-description">This case is not linked to any invoice, PO, GRN, or payment.</div>
    </div>
    {% endif %}
</div>

